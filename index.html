<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brands Swiper + Grid</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div class="brands">
        <p>Ремонт техники различных брендов</p>

        <div class="brands-list">
            <div class="brand"><img src="./img/lenovo.png" alt="Lenovo"><button>→</button></div>
            <div class="brand"><img src="./img/samsung.png" alt="Samsung"><button>→</button></div>
            <div class="brand"><img src="./img/apple.png" alt="Apple"><button>→</button></div>
            <div class="brand"><img src="./img/bosch.png" alt="Bosch"><button>→</button></div>
            <div class="brand"><img src="./img/hp.png" alt="HP"><button>→</button></div>
            <div class="brand"><img src="./img/acer.png" alt="Acer"><button>→</button></div>
            <div class="brand"><img src="./img/viewsonic.png" alt="ViewSonic"><button>→</button></div>
            <div class="brand"><img src="./img/sony.png" alt="Sony"><button>→</button></div>
        </div>

        <button class="toggle-btn">Показать все</button>

        <div class="brands-swiper swiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide brand"><img src="./img/lenovo.png" alt="Lenovo"><button>→</button></div>
                <div class="swiper-slide brand"><img src="./img/samsung.png" alt="Samsung"><button>→</button></div>
                <div class="swiper-slide brand"><img src="./img/apple.png" alt="Apple"><button>→</button></div>
                <div class="swiper-slide brand"><img src="./img/bosch.png" alt="Bosch"><button>→</button></div>
                <div class="swiper-slide brand"><img src="./img/hp.png" alt="HP"><button>→</button></div>
                <div class="swiper-slide brand"><img src="./img/acer.png" alt="Acer"><button>→</button></div>
                <div class="swiper-slide brand"><img src="./img/viewsonic.png" alt="ViewSonic"><button>→</button></div>
                <div class="swiper-slide brand"><img src="./img/sony.png" alt="Sony"><button>→</button></div>
            </div>
            <div class="swiper-pagination"></div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script>
        const list = document.querySelector('.brands-list');
        const btn = document.querySelector('.toggle-btn');
        let swiper = null;

        // вычисляем высоту по количеству видимых рядов
        function getCollapsedHeight(rows = 2) {
            if (!list) return 0;
            const items = [...list.querySelectorAll('.brand')];
            if (!items.length) return 0;

            const tops = [...new Set(items.map(el => el.offsetTop))].sort((a, b) => a - b);
            const lastRowIndex = Math.min(rows, tops.length) - 1;
            const lastRowTop = tops[lastRowIndex];
            const rowItems = items.filter(el => el.offsetTop === lastRowTop);
            const bottom = Math.max(...rowItems.map(el => el.offsetTop + el.offsetHeight));
            return bottom - list.offsetTop;
        }

        // применяем высоту
        function applyCollapsedHeight() {
            const collapsedHeight = getCollapsedHeight(2); // показываем 2 ряда
            if (!list.classList.contains('open')) {
                list.style.maxHeight = collapsedHeight + 'px';
            } else {
                list.style.maxHeight = 'none';
            }
        }

        // инициализация swiper
        function initSwiper() {
            const width = window.innerWidth;
            if (width <= 480 && !swiper) {
                swiper = new Swiper('.brands-swiper', {
                    slidesPerView: 'auto',
                    spaceBetween: 12,
                    pagination: {
                        el: '.swiper-pagination',
                        clickable: true
                    }
                });
            } else if (width > 480 && swiper) {
                swiper.destroy(true, true);
                swiper = null;
            }
        }

        if (list && btn) {
            btn.addEventListener('click', () => {
                list.classList.toggle('open');
                btn.textContent = list.classList.contains('open') ? 'Скрыть' : 'Показать все';
                applyCollapsedHeight();
            });

            window.addEventListener('resize', () => {
                applyCollapsedHeight();
                initSwiper();
            });

            window.addEventListener('load', () => {
                applyCollapsedHeight();
                initSwiper();
            });
        }
    </script>


</body>

</html>